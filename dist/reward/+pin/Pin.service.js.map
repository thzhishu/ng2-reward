{"version":3,"file":"Pin.service.js","sourceRoot":"","sources":["../../../../../../src/reward/+pin/Pin.service.ts"],"names":[],"mappings":"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","sourcesContent":["import {Injectable} from '@angular/core';\nimport {Http, Response, URLSearchParams, Headers, RequestOptions } from '@angular/http';\nimport { Observable } from 'rxjs/Observable';\nimport {baseUrl} from '../services/config';\n\nexport class PinProgram {\n    constructor(public cRPId?: number,public cRPDId?:number, public cRPRewardType?: number, public cRPName?: string, public cRPNameShow?: number,\n        public cRPSubtitle?: string, public cRPSubtitleShow?: number, public cRPBackgroundAdd?: string,\n        public cRPBackgroundShow?: number, public cRPDesc?: string, public cRPDescShow?: number,\n        public cRPValidDate?: string, public cRPValidStartDate?: string, public cRPValidEndDate?: string,\n        public cRPValidType?: number, public cRPRate?: number,\n        public cRPRateContent?: string, public totalRewards?: number, public cRPCodeType?: number,\n        public cRPCodeCommon?: string, public cRPGenerateType?: number, public fileName?: string,\n        public cRPNoticeNow?: number, public cRPNoticeNowContent?: string, public cRPValidNotice?: number,\n        public cRPValidNoticeDay?: string, public cRPValidNoticeContent?: string) {\n    }\n}\n\nexport class PinParams {\n    constructor(public cRPId?: number, public startDate?: string, public endDate?: string, public projectId?: number, public currentPage?: number, public pageSize?: number, public status?: number) {\n\n    }\n}\n\nconst PinAddUrl = baseUrl + '/rewardManage/check/add';\nconst PinEditUrl = baseUrl + '/rewardManage/check/edit';\nconst PinInfoUrl = baseUrl + '/rewardManage/info/query/';\n\n@Injectable()\nexport class PinService {\n    program: PinProgram;\n    id: number;\n    constructor(private http: Http) {\n\n    }\n\n    ngOnInit() {\n\n    }\n\n    getOne(id) {\n        return this.http.get(PinInfoUrl + id).map(res => res.json()).catch(this.handleError);\n    }\n\n    /**\n     * 新增和修改核验型奖励\n     * @param  {[object]} data [插入数据]\n     * @return {[Observables]}      [observables 数据]\n     */\n    add(data) {\n        let URL;\n        if (data.cRPId === null || data.cRPId === undefined || isNaN(data.cRPId)) {\n            URL = PinAddUrl //新增\n        } else {\n            URL = PinEditUrl//修改\n        }\n        //加工数据\n        data.cRPNameShow = data.cRPNameShow ? 1 : 0;\n        data.cRPSubtitleShow = data.cRPSubtitleShow ? 1 : 0;\n        data.cRPBackgroundShow = data.cRPBackgroundShow ? 1 : 0;\n        data.cRPDescShow = data.cRPDescShow ? 1 : 0;\n        data.cRPNoticeNow = data.cRPNoticeNow ? 1 : 0;\n        data.cRPValidNotice = data.cRPValidNotice ? 1 : 0;\n        let body = JSON.stringify(data);\n        let headers = new Headers({ 'Content-Type': 'application/json' });\n        let options = new RequestOptions({ headers: headers });\n        return this.http.post(URL, body, options).map(res => res.json()).catch(this.handleError);\n    }\n\n    /**\n     * 删除核验型奖励\n     * @param  {[number]} id\n     * @return {[Observables]}  [observables 数据]\n     */\n    delete(id) {\n        let URL = baseUrl + '/rewardManage/status/edit';\n        let data = { cRPId: id, cRPStatus: 0 };//0删除,1发放中,2暂停中\n        let body = JSON.stringify(data);\n        let headers = new Headers({ 'Content-Type': 'application/json' });\n        let options = new RequestOptions({ headers: headers });\n        return this.http.post(URL, body, options).map(res => res.json()).catch(this.handleError);\n    }\n    /**\n     * 发放/暂停核验型奖励\n     * @param  {[type]} id\n     * @param  {[type]} state [0删除,1发放中,2暂停中]\n     * @return {[type]}       [observables 数据]\n     */\n    putState(id, state) {\n        let URL = baseUrl + '/rewardManage/status/edit';\n        let data = { cRPId: id, cRPStatus: state };//0删除,1发放中,2暂停中\n        let body = JSON.stringify(data);\n        let headers = new Headers({ 'Content-Type': 'application/json' });\n        let options = new RequestOptions({ headers: headers });\n        return this.http.post(URL, body, options).map(res => res.json()).catch(this.handleError);\n    }\n    /**\n     * 关联项目\n     * @param  {[object]} params [cRPId,queryType:[1当前正在关联的/2所有的关联的，包括历史]]\n     * @return {[Observables]}   [observables 数据]\n     */\n    projectsList(params) {\n        let search = new URLSearchParams();\n        search.set('cRPId', params.cRPId);\n        search.set('queryType', params.queryType);\n        let URL = baseUrl + '/rewardManage/projects/list';\n        return this.http.get(URL, { search: search }).map(res => res.json()).catch(this.handleError);\n    }\n    /**\n     * 奖励列表\n     * @param  {[object]} params [cRPId,startDate,endDate,projectId,cRPDId]\n     * @return {[Observables]}   [observables 数据]\n     */\n    pinList(params) {\n        let search = new URLSearchParams();\n        search.set('cRPId', params.cRPId + '');\n        search.set('cRPDId', params.cRPDId + '');\n        search.set('startDate', params.startDate);\n        search.set('endDate', params.endDate);\n        if (params.range == '-1') {\n            search.set('startDate', '');\n            search.set('endDate', '');\n        }\n        search.set('range', params.range + '');\n        search.set('sendStatus', params.sendStatus + '');\n        search.set('verifyStatus', params.verifyStatus + '');\n        search.set('projectId', params.projectId + '');\n        search.set('currentPage', params.currentPage + '');\n        search.set('pageSize', params.pageSize + '');\n        let URL = baseUrl + '/rewardManage/check/list';\n        return this.http.get(URL, { search: search }).map(res => res.json()).catch(this.handleError);\n    }\n    /**\n     * 发放总量\n     * @param  {[object]} id [奖励ID]\n     * @return {[Observables]}   [observables 数据]\n     */\n    totalList(id) {\n        let URL = baseUrl + '/rewardManage/check/total/' + id;\n        return this.http.get(URL).map(res => res.json()).catch(this.handleError);\n    }\n    /**\n     * 追加数量\n     * @param  {[type]} data [description]\n     * @return {[type]}      [description]\n     */\n    addTotal(data) {\n        let URL = baseUrl + '/rewardManage/nums/append';\n        let body = JSON.stringify(data);\n        let headers = new Headers({ 'Content-Type': 'application/json' });\n        let options = new RequestOptions({ headers: headers });\n        return this.http.post(URL, body, options).map(res => res.json()).catch(this.handleError);\n    }\n\n    private handleError(error: any) {\n        // In a real world app, we might use a remote logging infrastructure\n        let errMsg = error.message || 'Server error';\n        console.error(errMsg); // log to console instead\n        return Observable.throw(errMsg);\n    }\n}\n"]}